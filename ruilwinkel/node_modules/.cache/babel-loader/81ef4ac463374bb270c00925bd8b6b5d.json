{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\n\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\n\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\n\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\n\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\n\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\n\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/slicedToArray\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\n\nvar _ParseFileEncode = require(\"./ParseFileEncode\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n\n    if (enumerableOnly) symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      var _context2;\n\n      _forEachInstanceProperty(_context2 = ownKeys(Object(source), true)).call(_context2, function (key) {\n        (0, _defineProperty2.default)(target, key, source[key]);\n      });\n    } else if (_Object$getOwnPropertyDescriptors) {\n      _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source));\n    } else {\n      var _context3;\n\n      _forEachInstanceProperty(_context3 = ownKeys(Object(source))).call(_context3, function (key) {\n        _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar XHR = null;\n\nif (typeof XMLHttpRequest !== 'undefined') {\n  XHR = XMLHttpRequest;\n}\n\nvar DefaultController = {\n  saveFile: function () {\n    var _saveFile = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(name\n    /*: string*/\n    , source\n    /*: FileSource*/\n    , options\n    /*:: ?: FullOptions*/\n    ) {\n      var base64Data, _base64Data$split, _base64Data$split2, first, second, data, newSource;\n\n      return _regenerator.default.wrap(function (_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(source.format !== 'file')) {\n                _context.next = 2;\n                break;\n              }\n\n              throw new Error('saveFile can only be used with File-type sources.');\n\n            case 2:\n              _context.next = 4;\n              return new _promise.default(function (res, rej) {\n                // eslint-disable-next-line no-undef\n                var reader = new FileReader();\n\n                reader.onload = function () {\n                  return res(reader.result);\n                };\n\n                reader.onerror = function (error) {\n                  return rej(error);\n                };\n\n                reader.readAsDataURL(source.file);\n              });\n\n            case 4:\n              base64Data = _context.sent; // we only want the data after the comma\n              // For example: \"data:application/pdf;base64,JVBERi0xLjQKJ...\" we would only want \"JVBERi0xLjQKJ...\"\n\n              _base64Data$split = base64Data.split(','), _base64Data$split2 = (0, _slicedToArray2.default)(_base64Data$split, 2), first = _base64Data$split2[0], second = _base64Data$split2[1]; // in the event there is no 'data:application/pdf;base64,' at the beginning of the base64 string\n              // use the entire string instead\n\n              data = second ? second : first;\n              newSource = {\n                format: 'base64',\n                base64: data,\n                type: source.type || (source.file ? source.file.type : null)\n              };\n              _context.next = 10;\n              return DefaultController.saveBase64(name, newSource, options);\n\n            case 10:\n              return _context.abrupt(\"return\", _context.sent);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function () {\n      return _saveFile.apply(this, arguments);\n    };\n  }(),\n  saveBase64: function (name\n  /*: string*/\n  , source\n  /*: FileSource*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    if (source.format !== 'base64') {\n      throw new Error('saveBase64 can only be used with Base64-type sources.');\n    }\n\n    var data\n    /*: { base64: any, _ContentType?: any, fileData: Object }*/\n    = {\n      base64: source.base64,\n      fileData: {\n        ipfs: options.ipfs,\n        metadata: _objectSpread({}, options.metadata),\n        tags: _objectSpread({}, options.tags)\n      }\n    };\n    delete options.metadata;\n    delete options.tags;\n\n    if (source.type) {\n      data._ContentType = source.type;\n    }\n\n    return _CoreManager.default.getRESTController().request('POST', 'files/' + name, data, options);\n  },\n  download: function (uri, options) {\n    if (XHR) {\n      return this.downloadAjax(uri, options);\n    } else {\n      return _promise.default.reject('Cannot make a request: No definition of XMLHttpRequest was found.');\n    }\n  },\n  downloadAjax: function (uri, options) {\n    return new _promise.default(function (resolve, reject) {\n      var xhr = new XHR();\n      xhr.open('GET', uri, true);\n      xhr.responseType = 'arraybuffer';\n\n      xhr.onerror = function (e) {\n        reject(e);\n      };\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState !== xhr.DONE) {\n          return;\n        }\n\n        if (!this.response) {\n          return resolve({});\n        }\n\n        var bytes = new Uint8Array(this.response);\n        resolve({\n          base64: (0, _ParseFileEncode.encodeBase64)(bytes),\n          contentType: xhr.getResponseHeader('content-type')\n        });\n      };\n\n      options.requestTask(xhr);\n      xhr.send();\n    });\n  },\n  deleteFile: function (name\n  /*: string*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    var headers = {\n      'X-Parse-Application-ID': _CoreManager.default.get('APPLICATION_ID')\n    };\n\n    if (options.useMasterKey) {\n      headers['X-Parse-Master-Key'] = _CoreManager.default.get('MASTER_KEY');\n    }\n\n    var url = _CoreManager.default.get('SERVER_URL');\n\n    if (url[url.length - 1] !== '/') {\n      url += '/';\n    }\n\n    url += 'files/' + name;\n    return _CoreManager.default.getRESTController().ajax('DELETE', url, '', headers).catch(function (response) {\n      // TODO: return JSON object in server\n      if (!response || response === 'SyntaxError: Unexpected end of JSON input') {\n        return _promise.default.resolve();\n      } else {\n        return _CoreManager.default.getRESTController().handleError(response);\n      }\n    });\n  },\n  _setXHR: function (xhr\n  /*: any*/\n  ) {\n    XHR = xhr;\n  },\n  _getXHR: function () {\n    return XHR;\n  }\n};\nmodule.exports = DefaultController;","map":{"version":3,"sources":["C:/Users/Stygal/Documents/Zuyd/blok 4/Casusblok-4-jaar-2-groep-F4/ruilwinkel/node_modules/moralis/lib/browser/ParseFileController.default.js"],"names":["_interopRequireDefault","require","_Object$defineProperty","_Object$defineProperties","_Object$getOwnPropertyDescriptors","_forEachInstanceProperty","_Object$getOwnPropertyDescriptor","_filterInstanceProperty","_Object$getOwnPropertySymbols","_Object$keys","_indexOf","_defineProperty2","_regenerator","_slicedToArray2","_promise","_asyncToGenerator2","_CoreManager","_ParseFileEncode","ownKeys","object","enumerableOnly","keys","symbols","call","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","_context2","Object","key","default","_context3","XHR","XMLHttpRequest","DefaultController","saveFile","_saveFile","mark","_callee","name","options","base64Data","_base64Data$split","_base64Data$split2","first","second","data","newSource","wrap","_context","prev","next","format","Error","res","rej","reader","FileReader","onload","result","onerror","error","readAsDataURL","file","sent","split","base64","type","saveBase64","abrupt","stop","fileData","ipfs","metadata","tags","_ContentType","getRESTController","request","download","uri","downloadAjax","reject","resolve","xhr","open","responseType","e","onreadystatechange","readyState","DONE","response","bytes","Uint8Array","encodeBase64","contentType","getResponseHeader","requestTask","send","deleteFile","headers","get","useMasterKey","url","ajax","catch","handleError","_setXHR","_getXHR","module","exports"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\r\n\r\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\r\n\r\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\r\n\r\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\r\n\r\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\r\n\r\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\r\n\r\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\r\n\r\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\r\n\r\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\r\n\r\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\r\n\r\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\r\n\r\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\r\n\r\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/slicedToArray\"));\r\n\r\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\r\n\r\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\r\n\r\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\r\n\r\nvar _ParseFileEncode = require(\"./ParseFileEncode\");\r\n\r\nfunction ownKeys(object, enumerableOnly) {\r\n  var keys = _Object$keys(object);\r\n\r\n  if (_Object$getOwnPropertySymbols) {\r\n    var symbols = _Object$getOwnPropertySymbols(object);\r\n\r\n    if (enumerableOnly) symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\r\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\r\n    });\r\n    keys.push.apply(keys, symbols);\r\n  }\r\n\r\n  return keys;\r\n}\r\n\r\nfunction _objectSpread(target) {\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    var source = arguments[i] != null ? arguments[i] : {};\r\n\r\n    if (i % 2) {\r\n      var _context2;\r\n\r\n      _forEachInstanceProperty(_context2 = ownKeys(Object(source), true)).call(_context2, function (key) {\r\n        (0, _defineProperty2.default)(target, key, source[key]);\r\n      });\r\n    } else if (_Object$getOwnPropertyDescriptors) {\r\n      _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source));\r\n    } else {\r\n      var _context3;\r\n\r\n      _forEachInstanceProperty(_context3 = ownKeys(Object(source))).call(_context3, function (key) {\r\n        _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\r\n      });\r\n    }\r\n  }\r\n\r\n  return target;\r\n}\r\n\r\nvar XHR = null;\r\n\r\nif (typeof XMLHttpRequest !== 'undefined') {\r\n  XHR = XMLHttpRequest;\r\n}\r\n\r\nvar DefaultController = {\r\n  saveFile: function () {\r\n    var _saveFile = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(name\r\n    /*: string*/\r\n    , source\r\n    /*: FileSource*/\r\n    , options\r\n    /*:: ?: FullOptions*/\r\n    ) {\r\n      var base64Data, _base64Data$split, _base64Data$split2, first, second, data, newSource;\r\n\r\n      return _regenerator.default.wrap(function (_context) {\r\n        while (1) {\r\n          switch (_context.prev = _context.next) {\r\n            case 0:\r\n              if (!(source.format !== 'file')) {\r\n                _context.next = 2;\r\n                break;\r\n              }\r\n\r\n              throw new Error('saveFile can only be used with File-type sources.');\r\n\r\n            case 2:\r\n              _context.next = 4;\r\n              return new _promise.default(function (res, rej) {\r\n                // eslint-disable-next-line no-undef\r\n                var reader = new FileReader();\r\n\r\n                reader.onload = function () {\r\n                  return res(reader.result);\r\n                };\r\n\r\n                reader.onerror = function (error) {\r\n                  return rej(error);\r\n                };\r\n\r\n                reader.readAsDataURL(source.file);\r\n              });\r\n\r\n            case 4:\r\n              base64Data = _context.sent; // we only want the data after the comma\r\n              // For example: \"data:application/pdf;base64,JVBERi0xLjQKJ...\" we would only want \"JVBERi0xLjQKJ...\"\r\n\r\n              _base64Data$split = base64Data.split(','), _base64Data$split2 = (0, _slicedToArray2.default)(_base64Data$split, 2), first = _base64Data$split2[0], second = _base64Data$split2[1]; // in the event there is no 'data:application/pdf;base64,' at the beginning of the base64 string\r\n              // use the entire string instead\r\n\r\n              data = second ? second : first;\r\n              newSource = {\r\n                format: 'base64',\r\n                base64: data,\r\n                type: source.type || (source.file ? source.file.type : null)\r\n              };\r\n              _context.next = 10;\r\n              return DefaultController.saveBase64(name, newSource, options);\r\n\r\n            case 10:\r\n              return _context.abrupt(\"return\", _context.sent);\r\n\r\n            case 11:\r\n            case \"end\":\r\n              return _context.stop();\r\n          }\r\n        }\r\n      }, _callee);\r\n    }));\r\n\r\n    return function () {\r\n      return _saveFile.apply(this, arguments);\r\n    };\r\n  }(),\r\n  saveBase64: function (name\r\n  /*: string*/\r\n  , source\r\n  /*: FileSource*/\r\n  , options\r\n  /*:: ?: FullOptions*/\r\n  ) {\r\n    if (source.format !== 'base64') {\r\n      throw new Error('saveBase64 can only be used with Base64-type sources.');\r\n    }\r\n\r\n    var data\r\n    /*: { base64: any, _ContentType?: any, fileData: Object }*/\r\n    = {\r\n      base64: source.base64,\r\n      fileData: {\r\n        ipfs: options.ipfs,\r\n        metadata: _objectSpread({}, options.metadata),\r\n        tags: _objectSpread({}, options.tags)\r\n      }\r\n    };\r\n    delete options.metadata;\r\n    delete options.tags;\r\n\r\n    if (source.type) {\r\n      data._ContentType = source.type;\r\n    }\r\n\r\n    return _CoreManager.default.getRESTController().request('POST', 'files/' + name, data, options);\r\n  },\r\n  download: function (uri, options) {\r\n    if (XHR) {\r\n      return this.downloadAjax(uri, options);\r\n    } else {\r\n      return _promise.default.reject('Cannot make a request: No definition of XMLHttpRequest was found.');\r\n    }\r\n  },\r\n  downloadAjax: function (uri, options) {\r\n    return new _promise.default(function (resolve, reject) {\r\n      var xhr = new XHR();\r\n      xhr.open('GET', uri, true);\r\n      xhr.responseType = 'arraybuffer';\r\n\r\n      xhr.onerror = function (e) {\r\n        reject(e);\r\n      };\r\n\r\n      xhr.onreadystatechange = function () {\r\n        if (xhr.readyState !== xhr.DONE) {\r\n          return;\r\n        }\r\n\r\n        if (!this.response) {\r\n          return resolve({});\r\n        }\r\n\r\n        var bytes = new Uint8Array(this.response);\r\n        resolve({\r\n          base64: (0, _ParseFileEncode.encodeBase64)(bytes),\r\n          contentType: xhr.getResponseHeader('content-type')\r\n        });\r\n      };\r\n\r\n      options.requestTask(xhr);\r\n      xhr.send();\r\n    });\r\n  },\r\n  deleteFile: function (name\r\n  /*: string*/\r\n  , options\r\n  /*:: ?: FullOptions*/\r\n  ) {\r\n    var headers = {\r\n      'X-Parse-Application-ID': _CoreManager.default.get('APPLICATION_ID')\r\n    };\r\n\r\n    if (options.useMasterKey) {\r\n      headers['X-Parse-Master-Key'] = _CoreManager.default.get('MASTER_KEY');\r\n    }\r\n\r\n    var url = _CoreManager.default.get('SERVER_URL');\r\n\r\n    if (url[url.length - 1] !== '/') {\r\n      url += '/';\r\n    }\r\n\r\n    url += 'files/' + name;\r\n    return _CoreManager.default.getRESTController().ajax('DELETE', url, '', headers).catch(function (response) {\r\n      // TODO: return JSON object in server\r\n      if (!response || response === 'SyntaxError: Unexpected end of JSON input') {\r\n        return _promise.default.resolve();\r\n      } else {\r\n        return _CoreManager.default.getRESTController().handleError(response);\r\n      }\r\n    });\r\n  },\r\n  _setXHR: function (xhr\r\n  /*: any*/\r\n  ) {\r\n    XHR = xhr;\r\n  },\r\n  _getXHR: function () {\r\n    return XHR;\r\n  }\r\n};\r\nmodule.exports = DefaultController;"]},"metadata":{},"sourceType":"script"}